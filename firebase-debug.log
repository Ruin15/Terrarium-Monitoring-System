[debug] [2026-02-02T13:10:07.620Z] ----------------------------------------------------------------------
[debug] [2026-02-02T13:10:07.622Z] Command:       /home/repsa/.nvm/versions/node/v24.11.0/bin/node /home/repsa/.nvm/versions/node/v24.11.0/bin/firebase emulators:exec --only functions ./my-test-script.sh
[debug] [2026-02-02T13:10:07.623Z] CLI Version:   15.5.1
[debug] [2026-02-02T13:10:07.623Z] Platform:      linux
[debug] [2026-02-02T13:10:07.623Z] Node Version:  v24.11.0
[debug] [2026-02-02T13:10:07.623Z] Time:          Mon Feb 02 2026 21:10:07 GMT+0800 (Philippine Standard Time)
[debug] [2026-02-02T13:10:07.623Z] ----------------------------------------------------------------------
[debug] 
[debug] [2026-02-02T13:10:08.614Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2026-02-02T13:10:08.614Z] > authorizing via signed-in user (repsajodimus5@gmail.com)
[info] i  emulators: Starting emulators: functions {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: functions"}}
[debug] [2026-02-02T13:10:08.627Z] assigned listening specs for emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}]},"metadata":{"message":"assigned listening specs for emulators"}}
[debug] [2026-02-02T13:10:08.631Z] Write emulator hub locator at /tmp/hub-tearrarium-iot-monitoring.json
[debug] [2026-02-02T13:10:08.645Z] late-assigned ports for functions and eventarc emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"functions":[{"address":"127.0.0.1","family":"IPv4","port":5001}],"eventarc":[{"address":"127.0.0.1","family":"IPv4","port":9299}],"tasks":[{"address":"127.0.0.1","family":"IPv4","port":9499}]},"metadata":{"message":"late-assigned ports for functions and eventarc emulators"}}
[warn] ⚠  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: apphosting, auth, firestore, database, hosting, pubsub, storage, dataconnect {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mapphosting, auth, firestore, database, hosting, pubsub, storage, dataconnect\u001b[22m"}}
[debug] [2026-02-02T13:10:08.741Z] defaultcredentials: writing to file /home/repsa/.config/firebase/repsajodimus5_gmail_com_application_default_credentials.json
[debug] [2026-02-02T13:10:08.744Z] Setting GAC to /home/repsa/.config/firebase/repsajodimus5_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to /home/repsa/.config/firebase/repsajodimus5_gmail_com_application_default_credentials.json"}}
[debug] [2026-02-02T13:10:08.745Z] Checked if tokens are valid: true, expires at: 1770040421437
[debug] [2026-02-02T13:10:08.746Z] Checked if tokens are valid: true, expires at: 1770040421437
[debug] [2026-02-02T13:10:08.746Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/tearrarium-iot-monitoring/adminSdkConfig [none]
[debug] [2026-02-02T13:10:10.688Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/tearrarium-iot-monitoring/adminSdkConfig 200
[debug] [2026-02-02T13:10:10.688Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/tearrarium-iot-monitoring/adminSdkConfig {"projectId":"tearrarium-iot-monitoring","databaseURL":"https://tearrarium-iot-monitoring-default-rtdb.asia-southeast1.firebasedatabase.app","storageBucket":"tearrarium-iot-monitoring.firebasestorage.app"}
[info] i  functions: Watching "/home/repsa/projects/Terrarium-Monitoring-System/functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"/home/repsa/projects/Terrarium-Monitoring-System/functions\" for Cloud Functions..."}}
[debug] [2026-02-02T13:10:10.714Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[debug] [2026-02-02T13:10:12.223Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint .",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "24"
  },
  "main": "index.js",
  "dependencies": {
    "firebase-admin": "^13.6.0",
    "firebase-functions": "^7.0.4",
    "nodemailer": "^7.0.13",
    "sib-api-v3-sdk": "^8.5.0"
  },
  "devDependencies": {
    "eslint": "^8.15.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^3.4.1"
  },
  "private": true
}
[debug] [2026-02-02T13:10:12.224Z] Building nodejs source
[debug] [2026-02-02T13:10:12.224Z] Failed to find version of module node: reached end of search path /home/repsa/projects/Terrarium-Monitoring-System/functions/node_modules
[info] ✔  functions: Using node@24 from host. 
[info] i  functions: Loaded environment variables from .env, .env.local. 
[debug] [2026-02-02T13:10:12.230Z] Could not find functions.yaml. Must use http discovery
[debug] [2026-02-02T13:10:12.236Z] Found firebase-functions binary at '/home/repsa/projects/Terrarium-Monitoring-System/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8556

[debug] [2026-02-02T13:10:12.604Z] Got response from /__/functions.yaml {"endpoints":{"cleanupOldAlerts":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["asia-southeast1"],"labels":{},"scheduleTrigger":{"schedule":"every 24 hours","retryConfig":{}},"entryPoint":"cleanupOldAlerts"},"generateSensorAlerts":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["asia-southeast1"],"labels":{},"eventTrigger":{"eventType":"google.firebase.database.ref.v1.updated","eventFilters":{"instance":"tearrarium-iot-monitoring-default-rtdb"},"eventFilterPathPatterns":{"ref":"sensorData"},"retry":false},"entryPoint":"generateSensorAlerts"},"storeSensorDataToFirestore":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["asia-southeast1"],"labels":{},"eventTrigger":{"eventType":"google.firebase.database.ref.v1.updated","eventFilters":{"instance":"tearrarium-iot-monitoring-default-rtdb"},"eventFilterPathPatterns":{"ref":"sensorData"},"retry":false},"entryPoint":"storeSensorDataToFirestore"},"cleanupOldHourlyAggregates":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["asia-southeast1"],"labels":{},"scheduleTrigger":{"schedule":"every 24 hours","retryConfig":{}},"entryPoint":"cleanupOldHourlyAggregates"},"cleanupOldDailySummaries":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["asia-southeast1"],"labels":{},"scheduleTrigger":{"schedule":"every 24 hours","retryConfig":{}},"entryPoint":"cleanupOldDailySummaries"}},"specVersion":"v1alpha1","requiredAPIs":[{"api":"cloudscheduler.googleapis.com","reason":"Needed for scheduled functions."}],"extensions":{},"params":[{"name":"BREVO_SMTP_SERVER","description":"Brevo SMTP server hostname","type":"string","default":"smtp-relay.brevo.com"},{"name":"BREVO_SMTP_PORT","description":"Brevo SMTP port number","type":"string","default":"587"},{"name":"BREVO_SMTP_LOGIN","description":"Brevo SMTP login username","type":"string","default":"a0ee7d001@smtp-brevo.com"},{"name":"BREVO_SMTP_KEY","description":"Brevo SMTP API key","type":"string"},{"name":"BREVO_SENDER_EMAIL","description":"Email address to send notifications from","type":"string","default":"repsajodimus5@gmail.com"},{"name":"BREVO_SENDER_NAME","description":"Name to display as email sender","type":"string","default":"Terrarium Monitor"}]}
[info] ✔  functions: Loaded functions definitions from source: cleanupOldAlerts, generateSensorAlerts, storeSensorDataToFirestore, cleanupOldHourlyAggregates, cleanupOldDailySummaries. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: cleanupOldAlerts, generateSensorAlerts, storeSensorDataToFirestore, cleanupOldHourlyAggregates, cleanupOldDailySummaries."}}
[info] i  functions[asia-southeast1-cleanupOldAlerts]: function ignored because the pubsub emulator does not exist or is not running. {"metadata":{"emulator":{"name":"functions"},"message":"function ignored because the pubsub emulator does not exist or is not running."}}
[info] i  functions[asia-southeast1-generateSensorAlerts]: function ignored because the database emulator does not exist or is not running. {"metadata":{"emulator":{"name":"functions"},"message":"function ignored because the database emulator does not exist or is not running."}}
[info] i  functions[asia-southeast1-storeSensorDataToFirestore]: function ignored because the database emulator does not exist or is not running. {"metadata":{"emulator":{"name":"functions"},"message":"function ignored because the database emulator does not exist or is not running."}}
[info] i  functions[asia-southeast1-cleanupOldHourlyAggregates]: function ignored because the pubsub emulator does not exist or is not running. {"metadata":{"emulator":{"name":"functions"},"message":"function ignored because the pubsub emulator does not exist or is not running."}}
[info] i  functions[asia-southeast1-cleanupOldDailySummaries]: function ignored because the pubsub emulator does not exist or is not running. {"metadata":{"emulator":{"name":"functions"},"message":"function ignored because the pubsub emulator does not exist or is not running."}}
[debug] [2026-02-02T13:10:16.655Z] Could not find VSCode notification endpoint: FetchError: request to http://localhost:40001/vscode/notify failed, reason: connect ECONNREFUSED 127.0.0.1:40001. If you are not running the Firebase Data Connect VSCode extension, this is expected and not an issue.
[info] i  Running script: ./my-test-script.sh 
[debug] [2026-02-02T13:10:16.661Z] Running ./my-test-script.sh with environment {"SHELL":"/bin/bash","COLORTERM":"truecolor","NVM_INC":"/home/repsa/.nvm/versions/node/v24.11.0/include/node","WSL2_GUI_APPS_ENABLED":"1","TERM_PROGRAM_VERSION":"1.108.2","WSL_DISTRO_NAME":"Ubuntu","NAME":"ArdianvR135","PWD":"/home/repsa/projects/Terrarium-Monitoring-System","LOGNAME":"repsa","VSCODE_GIT_ASKPASS_NODE":"/home/repsa/.vscode-server/bin/c9d77990917f3102ada88be140d28b038d1dd7c7/node","HOME":"/home/repsa","LANG":"C.UTF-8","WSL_INTEROP":"/run/WSL/468_interop","LS_COLORS":"rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.avif=01;35:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:*~=00;90:*#=00;90:*.bak=00;90:*.crdownload=00;90:*.dpkg-dist=00;90:*.dpkg-new=00;90:*.dpkg-old=00;90:*.dpkg-tmp=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:*.swp=00;90:*.tmp=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:","WAYLAND_DISPLAY":"wayland-0","GIT_ASKPASS":"/home/repsa/.vscode-server/bin/c9d77990917f3102ada88be140d28b038d1dd7c7/extensions/git/dist/askpass.sh","NVM_DIR":"/home/repsa/.nvm","VSCODE_GIT_ASKPASS_EXTRA_ARGS":"","VSCODE_PYTHON_AUTOACTIVATE_GUARD":"1","LESSCLOSE":"/usr/bin/lesspipe %s %s","TERM":"xterm-256color","LESSOPEN":"| /usr/bin/lesspipe %s","USER":"repsa","VSCODE_GIT_IPC_HANDLE":"/run/user/1000/vscode-git-2f6a620f68.sock","DISPLAY":":0","SHLVL":"1","NVM_CD_FLAGS":"","XDG_RUNTIME_DIR":"/run/user/1000/","WSLENV":"VSCODE_WSL_EXT_LOCATION/up","VSCODE_GIT_ASKPASS_MAIN":"/home/repsa/.vscode-server/bin/c9d77990917f3102ada88be140d28b038d1dd7c7/extensions/git/dist/askpass-main.js","XDG_DATA_DIRS":"/usr/local/share:/usr/share:/var/lib/snapd/desktop","PATH":"/home/repsa/.vscode-server/data/User/globalStorage/github.copilot-chat/debugCommand:/home/repsa/.vscode-server/data/User/globalStorage/github.copilot-chat/copilotCli:/home/repsa/.vscode-server/bin/c9d77990917f3102ada88be140d28b038d1dd7c7/bin/remote-cli:/home/repsa/.nvm/versions/node/v24.11.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib:/mnt/c/Python313/Scripts/:/mnt/c/Python313/:/mnt/c/WINDOWS/system32:/mnt/c/WINDOWS:/mnt/c/WINDOWS/System32/Wbem:/mnt/c/WINDOWS/System32/WindowsPowerShell/v1.0/:/mnt/c/WINDOWS/System32/OpenSSH/:/mnt/c/ProgramData/chocolatey/bin:/mnt/c/nvm:/mnt/c/nvm4w/nodejs:/mnt/c/Users/repsa/AppData/Local/Microsoft/WindowsApps:/mnt/c/Users/repsa/AppData/Local/Programs/Microsoft VS Code/bin:/mnt/c/nvm:/mnt/c/nvm4w/nodejs:/snap/bin","DBUS_SESSION_BUS_ADDRESS":"unix:path=/run/user/1000/bus","NVM_BIN":"/home/repsa/.nvm/versions/node/v24.11.0/bin","HOSTTYPE":"x86_64","PULSE_SERVER":"unix:/mnt/wslg/PulseServer","TERM_PROGRAM":"vscode","VSCODE_IPC_HOOK_CLI":"/run/user/1000/vscode-ipc-60b76cdd-7b51-4396-8a2b-357afd79f3b7.sock","_":"/home/repsa/.nvm/versions/node/v24.11.0/bin/firebase","IS_FIREBASE_CLI":"true","GCLOUD_PROJECT":"tearrarium-iot-monitoring","FIREBASE_CONFIG":"{\"projectId\":\"tearrarium-iot-monitoring\",\"storageBucket\":\"tearrarium-iot-monitoring.appspot.com\",\"databaseURL\":\"https://tearrarium-iot-monitoring.firebaseio.com\"}","FIREBASE_EMULATOR_HUB":"127.0.0.1:4400","CLOUD_EVENTARC_EMULATOR_HOST":"http://127.0.0.1:9299","CLOUD_TASKS_EMULATOR_HOST":"127.0.0.1:9499"}
[warn] ⚠  Script exited unsuccessfully (code 127) 
[info] i  emulators: Shutting down emulators. {"metadata":{"emulator":{"name":"hub"},"message":"Shutting down emulators."}}
[info] i  functions: Stopping Functions Emulator {"metadata":{"emulator":{"name":"functions"},"message":"Stopping Functions Emulator"}}
[info] i  eventarc: Stopping Eventarc Emulator {"metadata":{"emulator":{"name":"eventarc"},"message":"Stopping Eventarc Emulator"}}
[info] i  tasks: Stopping Cloud Tasks Emulator {"metadata":{"emulator":{"name":"tasks"},"message":"Stopping Cloud Tasks Emulator"}}
[info] i  hub: Stopping emulator hub {"metadata":{"emulator":{"name":"hub"},"message":"Stopping emulator hub"}}
[info] i  logging: Stopping Logging Emulator {"metadata":{"emulator":{"name":"logging"},"message":"Stopping Logging Emulator"}}
[debug] [2026-02-02T13:10:17.192Z] Could not find VSCode notification endpoint: FetchError: request to http://localhost:40001/vscode/notify failed, reason: connect ECONNREFUSED 127.0.0.1:40001. If you are not running the Firebase Data Connect VSCode extension, this is expected and not an issue.
[error] 
[error] Error: Script "./my-test-script.sh" exited with code 127
[debug] [2026-02-02T13:10:17.483Z] Found emulator hub locator: {"version":"15.5.1","origins":["http://127.0.0.1:4400"],"pid":9121}
